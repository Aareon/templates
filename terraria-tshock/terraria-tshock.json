{
  "type": "terraria",
  "display": "Terraria - TShock",
  "data": {
    "arch": {
      "type": "option",
      "value": "x64",
      "display": "Architecture",
      "desc": "Architecture your machine",
      "required": true,
      "userEdit": false,
      "options": [
        {
          "value": "arm",
          "display": "arm"
        },
        {
          "value": "arm64",
          "display": "arm64"
        },
        {
          "value": "x64",
          "display": "amd64"
        }
      ]
    },
    "dotnetversion": {
      "type": "string",
      "value": "6.0.10",
      "display": ".NET Runtime Version",
      "desc": ".NET Runtime Version",
      "required": true,
      "userEdit": false
    },
    "ip": {
      "type": "string",
      "value": "0.0.0.0",
      "display": "IP",
      "desc": "Sets the IP address for the server to listen on - 0.0.0.0 means every possible IP",
      "required": true,
      "userEdit": false
    },
    "port": {
      "type": "integer",
      "value": 7777,
      "display": "Port",
      "desc": "What port to bind the server to",
      "required": true,
      "userEdit": false
    },
    "secure": {
      "type": "option",
      "value": "",
      "display": "secure",
      "desc": "Enable cheat protection ?",
      "required": true,
      "userEdit": false,
      "options": [
        {
          "value": "-secure",
          "display": "Yes"
        },
        {
          "value": "",
          "display": "No"
        }
      ]
    },
    "tshockversion": {
      "type": "string",
      "value": "5.1.3",
      "display": "TShock Version (Set this to the latest server version - see here https://github.com/Pryaxis/TShock/releases/latest)",
      "desc": "TShock Version",
      "required": true,
      "userEdit": false
    },
    "version": {
      "type": "string",
      "value": "1.4.4.9",
      "display": "Server Version",
      "desc": "Server Version (Set this to the latest server version)",
      "required": true,
      "userEdit": false
    },
    "wpath": {
      "type": "string",
      "value": "worlds",
      "display": "Worlds Path",
      "desc": "Name of the worlds folder",
      "required": true,
      "userEdit": false
    }
  },
  "install": [
    {
      "type": "download",
      "files": [
        "https://github.com/Pryaxis/TShock/releases/download/v${tshockversion}/TShock-${tshockversion}-for-Terraria-${version}-linux-${arch}-Release.zip",
        "https://dotnetcli.azureedge.net/dotnet/Runtime/${dotnetversion}/dotnet-runtime-${dotnetversion}-linux-${arch}.tar.gz"
      ]
    },
    {
      "type": "command",
      "commands": [
        "unzip TShock-${tshockversion}-for-Terraria-${version}-linux-${arch}-Release.zip",
        "tar xf TShock-Beta-linux-${arch}-Release.tar",
        "mkdir ${wpath}",
        "mkdir dotnet",
        "tar xzf dotnet-runtime-${dotnetversion}-linux-${arch}.tar.gz -C dotnet",
        "rm -rf TShock-${tshockversion}-for-Terraria-${version}-linux-${arch}-Release.zip",
        "rm -rf TShock-Beta-linux-${arch}-Release.tar",
        "rm -rf dotnet-runtime-linux-${arch}.tar.gz"
      ]
    }
  ],
  "run": {
    "command": "./TShock.Server -ip ${ip} -port ${port} -worldselectpath ${wpath} ${secure}",
    "stop": "exit",
    "environmentVars": {
      "DOTNET_ROOT": "${rootDir}/dotnet"
    },
    "stdin": {
      "type": "stdin"
    },
    "autostart": false,
    "autorecover": false,
    "autorestart": false
  },
  "environment": {
    "type": "tty"
  },
  "requirements": {
    "os": "linux",
    "binaries": [
      "unzip"
    ]
  }
}
